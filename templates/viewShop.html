<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All Products</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #F0F0F0;
            color: #333;
        }

        .main {
            height: 85vh;
            background-color: #E2F0D9;
            display: flex;
            flex-direction: column;
            align-items: center;
            color: white;
            padding-top: 60px;
            overflow-y: auto;
        }

        .main h1 {
            font-size: 2.5em;
            color: black;
        }

        /* Removed unused CSS classes */

        .shop-rating {
            display: flex;
            align-items: center;
        }

        .shop-rating p:first-child {
            color: #FFD700; /* Yellow color for stars */
        }

        /* Shop navigation tabs */
        .shop-tabs {
            width: 90%;
            max-width: 900px;
            display: flex;
            border-bottom: 2px solid #e2e2e2;
            margin-bottom: 18px;
        }
        .shop-tabs a {
            flex: 1;
            text-align: center;
            padding: 12px 0;
            text-decoration: none;
            font-size: 1.1em;
            color: #333;
        }
        .shop-tabs a.active {
            color: #e74c3c;
            font-weight: bold;
            border-bottom: 2px solid #e74c3c;
        }
        /* Product link and card hover effects */
        .product-link { text-decoration: none; color: inherit; }
        .product-card { transition: transform .15s ease, box-shadow .15s ease; cursor: pointer; }
        .product-link:hover .product-card { transform: translateY(-6px); box-shadow: 0 8px 20px rgba(0,0,0,0.12); }
    </style>
</head>
<body>

    {% include 'partials/navbar.html' %}

    <div class="main">
        <!-- Shop Header Card -->
        <div style="background: #fff; border-radius: 18px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); width: 90%; max-width: 900px; margin-bottom: 32px; display: flex; align-items: center; padding: 28px 32px; position: relative;">
            <div style="width: 90px; height: 90px; background: #f0f0f0; border: 2px solid #e2e2e2; border-radius: 50%; display: flex; align-items: center; justify-content: center; overflow: hidden; margin-right: 28px;">
                <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Shop Logo" style="width: 80px; height: 80px; object-fit: cover; border-radius: 50%;">
            </div>
            <div style="flex: 1;">
                <div style="display: flex; align-items: flex-start; justify-content: space-between;">
                    <div>
                        <h2 style="font-size: 2em; color: #2d3a2d; margin-bottom: 4px;">{{ shop.shop_name }}</h2>
                        <div style="font-size: 1em; color: #666; margin-bottom: 10px;">Owner: {{ shop.owner_name }}</div>
                        <div style="font-size: 1.15em; color: #666; margin-bottom: 12px;">{{ shop.description }}</div>
                    </div>
                    <div style="display: flex; flex-direction: column; align-items: flex-end; gap: 6px; min-width: 180px;">
                        <div style="font-size: 1em; color: #e67e22;">Rating: <span style="color: #e74c3c; font-weight: bold;">{{ '{:.1f}'.format(shop_rating) if shop_rating is not none else 'N/A' }}</span> <span style="color: #888;">({{ '{:,}'.format(rating_count) }} Rating{{ 's' if rating_count != 1 else '' }})</span></div>
                        <div style="font-size: 1em; color: #888;">Joined: {{ joined_str }}</div>
                        <div style="display: flex; gap: 8px; margin-top: 4px;">
                            <a href="{{ url_for('user_messages', shop_id=shop.id) }}" style="background: #E2F0D9; color: #333; border: none; border-radius: 8px; padding: 6px 14px; font-weight: 600; cursor: pointer; text-decoration: none; display: inline-block;">Chat</a>
                        </div>
                    </div>
                </div>
                <div style="margin-top: 10px; font-size: 1.1em; color: #444;">Contact #: {{ shop.phone }} &nbsp; | &nbsp; Email: {{ shop.email }}</div>
                <div style="margin-top: 10px; font-size: 1.1em; color: #444;">Products: <span style="color: #e74c3c; font-weight: bold;">{{ products|length }}</span></div>
            </div>
        </div>

        <!-- Shop Navigation Tabs -->
        <div class="shop-tabs">
            <a href="{{ url_for('view_shop', shop_id=shop.id) }}" class="{% if not selected_type %}active{% endif %}">Home</a>
            <a href="{{ url_for('view_shop', shop_id=shop.id) }}?type=All" class="{% if selected_type and selected_type.lower()=='all' %}active{% endif %}">All Products</a>
            <a href="{{ url_for('view_shop', shop_id=shop.id) }}?type=Crops" class="{% if selected_type and selected_type.lower()=='crops' %}active{% endif %}">Crops</a>
            <a href="{{ url_for('view_shop', shop_id=shop.id) }}?type=livestock" class="{% if selected_type and selected_type.lower()=='livestock' %}active{% endif %}">Livestocks</a>
            <a href="{{ url_for('view_shop', shop_id=shop.id) }}?type=Poultry" class="{% if selected_type and selected_type.lower()=='poultry' %}active{% endif %}">Poultry</a>
        </div>

        <!-- Recommended For You Title -->
        <div style="width: 90%; max-width: 900px; margin-bottom: 12px;">
            <h3 style="font-size: 1.3em; color: #2d3a2d; font-weight: 600;">RECOMMENDED FOR YOU</h3>
        </div>

        <!-- Products Grid -->
        <div style="width: 90%; max-width: 900px; display: grid; grid-template-columns: repeat(6, 1fr); gap: 18px; margin-bottom: 40px;">
            {% for product in products %}
            <a class="product-link" href="{{ url_for('view_product', product_id=product.id) }}">
            <div class="product-card" style="background: #fff; border-radius: 14px; box-shadow: 0 1px 4px rgba(0,0,0,0.07); padding: 12px; display: flex; flex-direction: column; align-items: center; border: 1px solid #e2e2e2;">
                {% if product.image %}
                    {% if product.image.startswith('http') or product.image.startswith('https') %}
                        <img src="{{ product.image }}" alt="{{ product.name }}" style="width: 110px; height: 110px; object-fit: cover; border-radius: 10px; border: 1px solid #eee; margin-bottom: 10px;">
                    {% elif product.image.startswith('/') %}
                        <img src="{{ product.image }}" alt="{{ product.name }}" style="width: 110px; height: 110px; object-fit: cover; border-radius: 10px; border: 1px solid #eee; margin-bottom: 10px;">
                    {% else %}
                        <img src="{{ url_for('static', filename='images/product-images/' ~ product.image) }}" alt="{{ product.name }}" style="width: 110px; height: 110px; object-fit: cover; border-radius: 10px; border: 1px solid #eee; margin-bottom: 10px;">
                    {% endif %}
                {% else %}
                    <img src="{{ url_for('static', filename='images/product-images/kalabasa.jpg') }}" alt="{{ product.name }}" style="width: 110px; height: 110px; object-fit: cover; border-radius: 10px; border: 1px solid #eee; margin-bottom: 10px;">
                {% endif %}
                <div style="width: 100%;">
                    <div style="font-size: 1em; font-weight: 600; color: #333; margin-bottom: 2px;">{{ product.name }}</div>
                    <div style="font-size: 0.9em; color: #666; margin-bottom: 2px;">Sold by: <span style="color:#2d3a2d; font-weight:600;">{{ shop.shop_name }}</span></div>
                    <div style="font-size: 0.95em; color: #e74c3c; font-weight: bold;">₱{{ '{:,.0f}'.format(product.price) }}
                        {# Optionally show old price if available #}
                    </div>
                    <div style="font-size: 0.9em; color: #888; margin-bottom: 2px;">Available: {{ product.available }} &nbsp;|&nbsp; Sold: {{ product.sold }}</div>
                    <div style="font-size: 0.9em; color: #FFD700; font-weight: bold;">★ {{ '{:.1f}'.format(product.rating) }}</div>
                </div>
            </div>
            </a>
            {% endfor %}
        </div>
    </div>
</body>
</html>